# WxProxy-微信请求代理

## 前言 

之前写了一个[用于解决微信回调域名限制的请求转发工具](https://github.com/ParrySMS/ReqForward), 但是代码结构有些混乱，而且也未支持全部的请求转发，实际部署使用起来也比较麻烦，因此重新阅读了一遍微信开发文档，根据自己的想法重写写了一下这个工具，换个名字叫 `WxProxy-微信请求代理`

## 开发说明
```
开发ing

尚未完成
```

## 请求流程说明 

由于微信服务号后台限制只能有1个回调域名，当业务需求需要多个域名使用同一个服务号相关请求时，就必须要将相关业务部署到同一个域名下。为了解决这类问题，可指定一个回调域名用于转发微信相关的请求。例如，指定回调域名为 proxy.qq.com ，则需要向微信请求时，请求流程如下：

        
a.qq.com  ---请求--->  proxy.qq.com下的接口 ---请求---> 微信API接口

b.qq.com  ---请求--->  proxy.qq.com下的接口 ---请求---> 微信API接口

proxy.qq.com在接收到请求后，再次请求微信API接口，并将微信API接口的返回内容直输出返回。

## 公众号权限说明

不同的公众号类型具备不同的接口权限，调用之前请务必确认自己的订阅号或服务号拥有对应权限,具体详见[微信官方文档 https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1433401084](https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1433401084)


## 安全问题


#### 身份验证

请求转发必须加上对应的身份验证校验（例如JWT验证），必须保证是自己的业务域名进行相关调用，否则存在被他人恶意调用或攻击的风险。


#### 参数安全

请求转发可以有效保证服务号的appid和appsecret不暴露于其他业务中，并且提高了项目部署的灵活性（可以在多台机器下部署不同代码的不同项目，减少运维所需的工作）

## 代码说明

#### 配置文件 `config.php`

- 需要填写appid和appsecret的参数

#### 加密授权 `auth.php`

- 在该文件下设置`sign参数`和`action参数`的加密方式

#### 转发请求处理 `forward.php`

- 使用加密的`sign参数`进行身份校验


## 支持的请求列表

